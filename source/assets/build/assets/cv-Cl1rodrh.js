document.addEventListener("DOMContentLoaded",function(){const u="/assets/pdf/Nuruzzaman_Milon_cv.pdf",c=window.pdfjsLib;c&&c.GlobalWorkerOptions&&(c.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.7.107/pdf.worker.min.js");const i=document.getElementById("pdf-container"),L=document.getElementById("download-pdf"),y=document.getElementById("loading"),p=document.getElementById("error"),w=document.getElementById("prev-page"),m=document.getElementById("next-page"),D=document.getElementById("current-page"),M=document.getElementById("total-pages");let g=null,n=1,s=0,l=new Map;function h(e){y.style.display="none",p.style.display="block",p.textContent="Error: "+e,p.style.padding="20px",p.style.textAlign="center"}function x(){const t=(i.offsetWidth||window.innerWidth)-40,d=window.innerWidth<768?t:Math.min(t,800),r=Math.max(.8,d/612);return Math.min(r,2)}async function v(e,o){if(l.has(e)){const t=l.get(e);if(Math.abs(t.scale-o)>.01){const a=i.querySelector(`.pdf-page-wrapper[data-page="${e}"]`);a&&a.remove(),l.delete(e)}else{const a=i.querySelector(`.pdf-page-wrapper[data-page="${e}"]`);a&&(a.style.display="flex");return}}try{const t=await g.getPage(e),a=t.getViewport({scale:o}),d=document.createElement("div");d.classList.add("pdf-page-wrapper"),d.setAttribute("data-page",e);const r=document.createElement("canvas");r.classList.add("pdf-page"),d.appendChild(r),i.appendChild(d);const C=r.getContext("2d"),f=window.devicePixelRatio||1,k=a.width,B=a.height;r.width=k*f,r.height=B*f,r.style.width=k+"px",r.style.height=B+"px",C.scale(f,f);const F={canvasContext:C,viewport:a};await t.render(F).promise,l.set(e,{scale:o,wrapper:d})}catch(t){console.error(`Error rendering page ${e}:`,t),h(`Failed to render page ${e}: ${t.message}`)}}function E(){i.querySelectorAll(".pdf-page-wrapper").forEach(t=>{t.style.display="none"});const o=i.querySelector(`.pdf-page-wrapper[data-page="${n}"]`);o&&(o.style.display="flex"),w.disabled=n<=1,m.disabled=n>=s,D.textContent=n}async function P(){if(!g)return;const e=x();y.style.display="none",await v(n,e),E()}async function b(e){if(e<1||e>s)return;n=e;const o=x();await v(n,o),E()}async function I(){n>1&&await b(n-1)}async function S(){n<s&&await b(n+1)}function j(e,o){let t;return function(...d){const r=()=>{clearTimeout(t),e(...d)};clearTimeout(t),t=setTimeout(r,o)}}const W=j(()=>{g&&(l.clear(),P())},250);window.addEventListener("resize",W),window.addEventListener("orientationchange",()=>{setTimeout(W,100)}),c?c.getDocument(u).promise.then(e=>{g=e,s=e.numPages,M.textContent=s,console.log("PDF loaded, total pages:",s),P()}).catch(e=>{console.error("Error loading PDF:",e),h("Failed to load PDF. Please check if the file exists. "+e.message)}):h("PDF.js library failed to load. Please refresh the page."),w.addEventListener("click",I),m.addEventListener("click",S),L.addEventListener("click",()=>{const e=document.createElement("a");e.href=u,e.download=u.split("/").pop(),document.body.appendChild(e),e.click(),document.body.removeChild(e)})});
